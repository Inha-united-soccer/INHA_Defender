<root BTCPP_format="4">
    <!-- Include necessary subtrees -->
    <include path="./subtrees/cam_find_and_track_ball.xml" />
    <include path="./subtrees/locate.xml" />

    <BehaviorTree ID="TestKick">
        <ReactiveSequence>
            <!-- Vision & Localization -->
            <SubTree ID="CamFindAndTrackBall" _autoremap="true" />
            <SelfLocate mode="trust_direction" /> 
            
            <!-- 킥 방향 개선 (골키퍼 고려) -->
            <CalcKickDirWithGoalkeeper cross_threshold="0.5" goalkeeper_margin="0.53" />

            <!-- Chase -> Adjust -> Kick -->
            <Sequence>
                <Chase vx_limit="0.9" vy_limit="0.2" vtheta_limit="1.0" dist="0.4" safe_dist="0.5" />

                <Adjust turn_threshold="0.5" range="0.6" vx_limit="0.7" vy_limit="0.6" vtheta_limit="1.5" vtheta_factor="1.5" tangential_speed_far="0.7" tangential_speed_near="0.15" kick_y_offset="-0.12" />

                
                <Kick speed_limit="1.3" vx_limit="1.3" vy_limit="0.3" min_msec_kick="1000" msecs_stablize="1000" kick_type="kick" />
                
            </Sequence>
        </ReactiveSequence>
    </BehaviorTree>
</root>
